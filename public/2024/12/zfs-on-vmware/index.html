<!DOCTYPE html>

<html class="no-js" itemscope="" itemtype="https://schema.org/Blog" lang="en-GB" prefix="og: https://ogp.me/ns#">
<head><link as="style" href="/wp-content/cache/wpo-minify/1769613917/assets/wpo-minify-header-60a11f4e.min.css" rel="preload"/><link as="style" href="/wp-content/themes/kadence/assets/css/rankmath.min.css" rel="preload"/><link as="style" href="/wp-content/themes/kadence/assets/css/footer.min.css" rel="preload"/><link as="style" href="/wp-content/themes/kadence/assets/css/kadence-splide.min.css" rel="preload"/><link as="style" href="/wp-content/themes/kadence/assets/css/related-posts.min.css" rel="preload"/><link as="font" crossorigin="anonymous" href="/assets/fonts/spacegrotesk-v22-latin-500.woff2" rel="preload" type="font/woff2"/><link as="font" crossorigin="anonymous" href="/assets/fonts/spacegrotesk-v22-latin-400.woff2" rel="preload" type="font/woff2"/><link as="font" crossorigin="anonymous" href="/assets/fonts/anton-v27-latin-400.woff2" rel="preload" type="font/woff2"/><link href="//plausible.jameskilby.cloud" rel="dns-prefetch"/><link crossorigin="" href="https://plausible.jameskilby.cloud" rel="preconnect"/>
<link as="script" href="/wp-content/cache/wpo-minify/1769613917/assets/wpo-minify-footer-20d41812.min.js" rel="preload"/>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1, minimum-scale=1" name="viewport"/>
<!-- Search Engine Optimization by Rank Math - https://rankmath.com/ -->
<title>How To Run ZFS On VMware VSphere: Setup Guide And Best Practices - Jameskilbycouk</title>
<meta content="ZFS,VMware,Best Practices for seamless integration and performance. Learn how to optimize your setup for maximum efficiency and reliability." name="description"/>
<meta content="index, follow, max-snippet:-1, max-video-preview:-1, max-image-preview:large" name="robots"/>
<link href="/2024/12/zfs-on-vmware/" rel="canonical"/>
<meta content="en_GB" property="og:locale">
<meta content="article" property="og:type">
<meta content="Mastering ZFS On VMware: Key Best Practices" property="og:title"/>
<meta content="Unlock the potential of ZFS on VMware. Optimize your setup today!" property="og:description"/>
<meta content="/2024/12/zfs-on-vmware/" property="og:url"/>
<meta content="Jameskilbycouk" property="og:site_name"/>
<meta content="Homelab" property="article:tag"/>
<meta content="Trim" property="article:tag"/>
<meta content="UNMAP" property="article:tag"/>
<meta content="VMware" property="article:tag"/>
<meta content="ZFS" property="article:tag"/>
<meta content="TrueNAS Scale" property="article:section"/>
<meta content="2026-01-18T21:36:48+00:00" property="og:updated_time"/>
<meta content="/wp-content/uploads/2024/12/IMG_20140330_210511-1024x845.jpeg" property="og:image"/>
<meta content="/wp-content/uploads/2024/12/IMG_20140330_210511-1024x845.jpeg" property="og:image:secure_url"/>
<meta content="ZFS" property="og:image:alt"/>
<meta content="2024-12-18T17:47:57+00:00" property="article:published_time"/>
<meta content="2026-01-18T21:36:48+00:00" property="article:modified_time"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="Mastering ZFS On VMware: Key Best Practices" name="twitter:title"/>
<meta content="Unlock the potential of ZFS on VMware. Optimize your setup today!" name="twitter:description"/>
<meta content="/wp-content/uploads/2024/12/IMG_20140330_210511-1024x845.jpeg" name="twitter:image"/>
<meta content="Written by" name="twitter:label1"/>
<meta content="James" name="twitter:data1"/>
<meta content="Time to read" name="twitter:label2"/>
<meta content="3 minutes" name="twitter:data2"/>
<script class="rank-math-schema" type="application/ld+json">{"@context":"https://schema.org","@graph":[{"@type":["Person","Organization"],"@id":"/#person","name":"Jameskilbycouk","logo":{"@type":"ImageObject","@id":"/#logo","url":"/wp-content/uploads/2025/12/ChatGPT-Image-Dec-17-2025-at-09_03_10-PM.png","contentUrl":"/wp-content/uploads/2025/12/ChatGPT-Image-Dec-17-2025-at-09_03_10-PM.png","caption":"Jameskilbycouk","inLanguage":"en-GB","width":"1024","height":"1024"},"image":{"@type":"ImageObject","@id":"/#logo","url":"/wp-content/uploads/2025/12/ChatGPT-Image-Dec-17-2025-at-09_03_10-PM.png","contentUrl":"/wp-content/uploads/2025/12/ChatGPT-Image-Dec-17-2025-at-09_03_10-PM.png","caption":"Jameskilbycouk","inLanguage":"en-GB","width":"1024","height":"1024"},"url":"https://jameskilby.co.uk"},{"@type":"WebSite","@id":"/#website","url":"https://jameskilby.co.uk","name":"Jameskilbycouk","publisher":{"@id":"/#person"},"inLanguage":"en-GB"},{"@type":"ImageObject","@id":"/wp-content/uploads/2024/12/ZFS.jpg","url":"/wp-content/uploads/2024/12/ZFS.jpg","width":"200","height":"132","inLanguage":"en-GB"},{"@type":"BreadcrumbList","@id":"/2024/12/zfs-on-vmware/#breadcrumb","itemListElement":[{"@type":"ListItem","position":"1","item":{"@id":"https://jameskilby.co.uk","name":"Home"}},{"@type":"ListItem","position":"2","item":{"@id":"/2024/12/zfs-on-vmware/","name":"How to Run ZFS on VMware vSphere: Setup Guide and Best Practices"}}]},{"@type":"WebPage","@id":"/2024/12/zfs-on-vmware/#webpage","url":"/2024/12/zfs-on-vmware/","name":"How To Run ZFS On VMware VSphere: Setup Guide And Best Practices - Jameskilbycouk","datePublished":"2024-12-18T17:47:57+00:00","dateModified":"2026-01-18T21:36:48+00:00","isPartOf":{"@id":"/#website"},"primaryImageOfPage":{"@id":"/wp-content/uploads/2024/12/ZFS.jpg"},"inLanguage":"en-GB","breadcrumb":{"@id":"/2024/12/zfs-on-vmware/#breadcrumb"}},{"@type":"Person","@id":"/author/admin/","name":"James","url":"/author/admin/","image":{"@type":"ImageObject","@id":"https://secure.gravatar.com/avatar/ef6adff58705e646065437e05c1828dd80a8f03997f0a97cf2b109df4eafd7aa?s=96&amp;d=mm&amp;r=g","url":"https://secure.gravatar.com/avatar/ef6adff58705e646065437e05c1828dd80a8f03997f0a97cf2b109df4eafd7aa?s=96&amp;d=mm&amp;r=g","caption":"James","inLanguage":"en-GB"},"sameAs":["https://wordpress.jameskilby.cloud"]},{"@type":"BlogPosting","headline":"How To Run ZFS On VMware VSphere: Setup Guide And Best Practices - Jameskilbycouk","keywords":"ZFS,VMware,Best Practices","datePublished":"2024-12-18T17:47:57+00:00","dateModified":"2026-01-18T21:36:48+00:00","author":{"@id":"/author/admin/","name":"James"},"publisher":{"@id":"/#person"},"description":"ZFS,VMware,Best Practices for seamless integration and performance. Learn how to optimize your setup for maximum efficiency and reliability.","name":"How To Run ZFS On VMware VSphere: Setup Guide And Best Practices - Jameskilbycouk","@id":"/2024/12/zfs-on-vmware/#richSnippet","isPartOf":{"@id":"/2024/12/zfs-on-vmware/#webpage"},"image":{"@id":"/wp-content/uploads/2024/12/ZFS.jpg"},"inLanguage":"en-GB","mainEntityOfPage":{"@id":"/2024/12/zfs-on-vmware/#webpage"},"wordCount":594,"timeRequired":"PT3M","articleBody":"Table of Contents I have run a number of systems using ZFS since the earliest days of my homelab using Nexenta, all the way back in 2010. The image below command is my lab at the time with an IBM head unit that I think had 18GB of RAM 6x450GB SAS drives and this was then connected to the Dell PowerVault SCSI Array above it with 14x146GB 10K SAS drives‚Ä¶. Original Nexenta Setup The number one rule is to ALWAYS give ZFS access to the underlying raw storage. You don‚Äôt want a raid controller or anything else interfering with the IO path. This is similar to how vSAN works with VMware. But rules are meant to be broken right‚Ä¶.. I have virtualized a few copies of TrueNAS Scale and Core which uses ZFS on top of VMware and in these particular instances I specifically DON‚ÄôT want to pass through the storage in the of an HBA or drives of an HBA or drives. Why would I do this? Mainly of two reasons. This allows me to test upgrades of my physical TrueNAS setup with an easy rollback if needed by not passing the drives or controllers in I can clone and snapshot the VMss just as if it was any other and move it around my lab infrastructure. Copy on Write ZFS is a ‚ÄúCopy on Write‚Äù file system which means that it never overwrites existing blocks of storage. It always places writes into new blocks. This is unfriendly with ‚Äúthin provisioning‚Äù something I am a huge fan of. This means that over time even a tiny database writing one megabyte file over and over again will slowly clog the entire file system. So if you‚Äôre going to break the rules. The way I see it is you might as well do it properly The first requirement is that the VM‚Äôs be provisioned with thin disks in vSphere. If is not thin then unmap won‚Äôt work. This is important in case you are thin at the underlay storage level. Disk IDs You also need to do is to to ensure that TrueNAS can see unique disk IDs. To do this shut down the VM‚Äôs and add the following parameter to the VMware VM‚Äôs configuration disk.EnableUUID=TRUE Once this is done when you power the VM‚Äôs on you should be able to see unique serials of each disk similar to this screenshot Prior to this change, the serial section is blank. Trim Once the disks are seen as unique it is possible to enable To confirm that trim is working execute the below command command. ( I have no idea why this is a blocker but it is) You can enable auto To confirm that trim is working execute the below command command in the Storage Dashboard under ‚ÄúZFS Health‚Äù I decided to manually enable it by executing the below command command in the shell. ( my Pool is called Pool-1) sudo zpool To confirm that trim is working execute the below command command Pool-1 To confirm that To confirm that trim is working execute the below command command is working execute the below command command sudo zpool status Pool-1 If everything is working you will see the To confirm that trim is working execute the below command command command as per below command A further validation that this is working is to review the VMss storage used, see the before and after of this VMss Additional confirmation can be seen by reviewing the underlying (vSAN consumption in this case). Before and after listed below command"}]}</script>
<!-- /Rank Math WordPress SEO plugin -->
<link href="/feed/" rel="alternate" title="Jameskilbycouk ¬ª Feed" type="application/rss+xml"/>
<link href="/comments/feed/" rel="alternate" title="Jameskilbycouk ¬ª Comments Feed" type="application/rss+xml"/>
<script>document.documentElement.classList.remove( 'no-js' );</script>
<link href="/2024/12/zfs-on-vmware/feed/" rel="alternate" title="Jameskilbycouk ¬ª How to Run ZFS on VMware vSphere: Setup Guide and Best Practices Comments Feed" type="application/rss+xml"/>
<link href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwordpress.jameskilby.cloud%2F2024%2F12%2Fzfs-on-vmware%2F" rel="alternate" title="oEmbed (JSON)" type="application/json+oembed"/>
<link href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwordpress.jameskilby.cloud%2F2024%2F12%2Fzfs-on-vmware%2F&amp;format=xml" rel="alternate" title="oEmbed (XML)" type="text/xml+oembed"/>
<link href="/assets/css/wp-block-image-inline-css-9dcc7ddb.min.css" media="all" rel="stylesheet"/><link href="/assets/css/consolidated-inline-styles.min.css" media="all" rel="stylesheet"/>
<link href="/assets/css/wp-block-code-inline-css-d1d93800.min.css" media="all" rel="stylesheet"/>
<link href="/wp-content/themes/kadence/assets/css/related-posts.min.css" id="kadence-related-posts-css" media="all" rel="stylesheet"/>
<link href="/wp-content/themes/kadence/assets/css/kadence-splide.min.css" id="kad-splide-css" media="all" rel="stylesheet"/>
<link href="/wp-content/themes/kadence/assets/css/footer.min.css" id="kadence-footer-css" media="all" rel="stylesheet"/>
<link href="/wp-content/themes/kadence/assets/css/rankmath.min.css" id="kadence-rankmath-css" media="all" rel="stylesheet"/>
<link href="/wp-content/cache/wpo-minify/1769613917/assets/wpo-minify-header-60a11f4e.min.css" id="wpo_min-header-0-css" media="all" rel="stylesheet"/>
<link href="/wp-json/wp/v2/posts/6247" rel="alternate" title="JSON" type="application/json"/><link href="/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="/?p=6247" rel="shortlink"/>
<link href="/xmlrpc.php" rel="pingback"/></meta></meta><meta content="max-age=86400" http-equiv="Cache-Control"/><meta content="WordPress Static Generator 1.0" name="generator"/><meta content="#0a0a0a" name="theme-color"/><link href="/favicon.ico" rel="icon" type="image/x-icon"/><link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"/><link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"/><link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180"/><link href="/site.webmanifest" rel="manifest"/><link as="style" href="/assets/css/brutalist-theme.css" rel="preload"/><link href="/assets/css/brutalist-theme.css" media="print" onload="this.media='all'" rel="stylesheet"/><noscript><link href="/assets/css/brutalist-theme.css" rel="stylesheet"/></noscript><script data-cfasync="false" data-domain="jameskilby.co.uk" defer="" src="https://plausible.jameskilby.cloud/js/script.js"></script></head>
<body class="wp-singular post-template-default single single-post postid-6247 single-format-standard wp-embed-responsive wp-theme-kadence hide-focus-outline link-style-standard content-title-style-normal content-width-narrow content-style-boxed content-vertical-padding-show non-transparent-header mobile-non-transparent-header">
<div class="site wp-site-blocks" id="wrapper">
<a class="skip-link screen-reader-text scroll-ignore" href="#main">Skip to content</a>
<header class="site-header" id="masthead" itemscope="" itemtype="https://schema.org/WPHeader" role="banner">
<div class="site-header-wrap" id="main-header">
<div class="site-header-inner-wrap">
<div class="site-header-upper-wrap">
<div class="site-header-upper-inner-wrap">
<div class="site-main-header-wrap site-header-row-container site-header-focus-item site-header-row-layout-standard" data-section="kadence_customizer_header_main">
<div class="site-header-row-container-inner">
<div class="site-container">
<div class="site-main-header-inner-wrap site-header-row site-header-row-has-sides site-header-row-no-center">
<div class="site-header-main-section-left site-header-section site-header-section-left">
<div class="site-header-item site-header-focus-item" data-section="title_tagline">
<div class="site-branding branding-layout-standard"><a class="brand" href="/" rel="home"><div class="site-title-wrap"><p class="site-title">Jameskilbycouk</p></div></a></div></div><!-- data-section="title_tagline" -->
</div>
<div class="site-header-main-section-right site-header-section site-header-section-right">
<div class="site-header-item site-header-focus-item site-header-item-main-navigation header-navigation-layout-stretch-false header-navigation-layout-fill-stretch-false" data-section="kadence_customizer_primary_navigation">
<nav aria-label="Primary" class="main-navigation header-navigation hover-to-open nav--toggle-sub header-navigation-style-standard header-navigation-dropdown-animation-none" id="site-navigation" role="navigation">
<div class="primary-menu-container header-menu-container">
<ul class="menu" id="primary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7329" id="menu-item-7329"><a href="/about-me/">About Me</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7324" id="menu-item-7324"><a href="/evs/">AWS EVS</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7325" id="menu-item-7325"><a href="/vmc/">VMC</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7327" id="menu-item-7327"><a href="/media/">Media</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7326" id="menu-item-7326"><a href="/homelab-software/">HomeLab ‚Äì Software</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7328" id="menu-item-7328"><a href="/lab/">Homelab ‚Äì Hardware</a></li>
</ul> </div>
</nav><!-- #site-navigation -->
</div><!-- data-section="primary_navigation" -->
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="site-mobile-header-wrap" id="mobile-header">
<div class="site-header-inner-wrap">
<div class="site-header-upper-wrap">
<div class="site-header-upper-inner-wrap">
<div class="site-main-header-wrap site-header-focus-item site-header-row-layout-standard site-header-row-tablet-layout-default site-header-row-mobile-layout-default">
<div class="site-header-row-container-inner">
<div class="site-container">
<div class="site-main-header-inner-wrap site-header-row site-header-row-has-sides site-header-row-no-center">
<div class="site-header-main-section-left site-header-section site-header-section-left">
<div class="site-header-item site-header-focus-item" data-section="title_tagline">
<div class="site-branding mobile-site-branding branding-layout-standard branding-tablet-layout-inherit branding-mobile-layout-inherit"><a class="brand" href="/" rel="home"><div class="site-title-wrap"><div class="site-title vs-md-false">Jameskilbycouk</div></div></a></div></div><!-- data-section="title_tagline" -->
</div>
<div class="site-header-main-section-right site-header-section site-header-section-right">
<div class="site-header-item site-header-focus-item site-header-item-navgation-popup-toggle" data-section="kadence_customizer_mobile_trigger">
<div class="mobile-toggle-open-container">
<button aria-expanded="false" aria-label="Open menu" class="menu-toggle-open drawer-toggle menu-toggle-style-default" data-set-focus=".menu-toggle-close" data-toggle-body-class="showing-popup-drawer-from-right" data-toggle-target="#mobile-drawer" id="mobile-toggle">
<span class="menu-toggle-icon"><span class="kadence-svg-iconset"><svg aria-hidden="true" class="kadence-svg-icon kadence-menu-svg" fill="currentColor" height="24" version="1.1" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title>Toggle Menu</title><path d="M3 13h18c0.552 0 1-0.448 1-1s-0.448-1-1-1h-18c-0.552 0-1 0.448-1 1s0.448 1 1 1zM3 7h18c0.552 0 1-0.448 1-1s-0.448-1-1-1h-18c-0.552 0-1 0.448-1 1s0.448 1 1 1zM3 19h18c0.552 0 1-0.448 1-1s-0.448-1-1-1h-18c-0.552 0-1 0.448-1 1s0.448 1 1 1z"></path>
</svg></span></span>
</button>
</div>
</div><!-- data-section="mobile_trigger" -->
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</header><!-- #masthead -->
<main class="wrap kt-clear" id="inner-wrap" role="main">
<div class="content-area" id="primary">
<div class="content-container site-container">
<div class="site-main" id="main">
<div class="content-wrap">
<div class="post-thumbnail article-post-thumbnail kadence-thumbnail-position-behind alignwide kadence-thumbnail-ratio-2-3">
<div class="post-thumbnail-inner">
<img alt="" class="post-top-featured wp-post-image" decoding="async" fetchpriority="high" height="132" loading="eager" src="/wp-content/uploads/2024/12/ZFS.jpg" width="200"/> </div>
</div><!-- .post-thumbnail -->
<article class="entry content-bg single-entry post-6247 post type-post status-publish format-standard has-post-thumbnail hentry category-truenas-scale category-vmware category-vsan-vmware category-vsphere tag-homelab tag-trim tag-unmap tag-vmware tag-zfs" id="post-6247">
<div class="entry-content-wrap">
<header class="entry-header post-title title-align-inherit title-tablet-align-inherit title-mobile-align-inherit">
<div class="entry-taxonomies">
<span class="category-links term-links category-style-normal">
<a href="/category/truenas-scale/" rel="tag">TrueNAS Scale</a> | <a href="/category/vmware/" rel="tag">VMware</a> | <a href="/category/vmware/vsan-vmware/" rel="tag">vSAN</a> | <a href="/category/vsphere/" rel="tag">vSphere</a> </span>
</div><!-- .entry-taxonomies -->
<h1 class="entry-title">How to Run ZFS on VMware vSphere: Setup Guide and Best Practices</h1><div class="entry-meta entry-meta-divider-dot">
<span class="posted-by"><span class="meta-label">By</span><span class="author vcard"><a class="url fn n" href="https://jameskilby.co.uk">James</a></span></span> <span class="posted-on">
<time class="entry-date published" datetime="2024-12-18T17:47:57+00:00" itemprop="datePublished">December 18, 2024</time><time class="updated" datetime="2026-01-18T21:36:48+00:00" itemprop="dateModified">January 18, 2026</time> </span>
<span class="reading-time" style="color: #718096;"><span> ‚Ä¢ </span><span style="margin-right: 4px;">üìñ</span><span>3 min read</span><span style="margin-left: 4px; color: #a0aec0;">(600 words)</span></span></div><!-- .entry-meta -->
</header><div class="content-freshness-indicator" style="background: #f7fafc; border-left: 4px solid #4299e1; 
            padding: 12px 16px; margin: 20px 0; border-radius: 4px; 
            font-size: 14px; line-height: 1.6; color: #2d3748;"><span style="font-size: 16px; margin-right: 8px;">üìÖ</span><span><strong>Published: </strong><time datetime="2024-12-18T17:47:57+00:00">December 18, 2024</time><span style="margin: 0 8px; color: #a0aec0;">‚Ä¢</span><strong>Updated: </strong><time datetime="2026-01-18T21:36:48+00:00">January 18, 2026</time></span></div><!-- .entry-header -->
<div class="entry-content single-content">
<div class="wp-block-rank-math-toc-block" id="rank-math-toc">
<h2>Table of Contents</h2>
<nav>
<ul>
<li><a href="#w">Copy on Write</a></li>
<li><a href="#disk-i-ds">Disk IDs</a></li>
<li><a href="#To confirm that trim is working execute the below command command">Trim</a></li>
</ul>
</nav></div>
<h2 class="wp-block-heading" id="intro">¬†</h2>
<p>I have run a number of systems using ZFS since the earliest days of my homelab using Nexenta, all the way back in 2010. The image below command is my lab at the time with an IBM head unit that I think had 18GB of RAM 6x450GB SAS drives and this was then connected to the Dell PowerVault SCSI Array above it with 14x146GB 10K SAS drives‚Ä¶.</p>
<figure class="wp-block-image size-large"><picture><source srcset="/wp-content/uploads/2024/12/IMG_20140330_210511-1024x845.avif" type="image/avif"/><source srcset="/wp-content/uploads/2024/12/IMG_20140330_210511-1024x845.webp" type="image/webp"/><img alt="" class="wp-image-6289" decoding="async" fetchpriority="high" height="845" loading="eager" sizes="(max-width: 1024px) 100vw, 1024px" src="/wp-content/uploads/2024/12/IMG_20140330_210511-1024x845.jpeg" srcset="/wp-content/uploads/2024/12/IMG_20140330_210511-1024x845.jpeg 1024w, /wp-content/uploads/2024/12/IMG_20140330_210511-300x247.jpeg 300w, /wp-content/uploads/2024/12/IMG_20140330_210511-768x634.jpeg 768w, /wp-content/uploads/2024/12/IMG_20140330_210511-1536x1267.jpeg 1536w, /wp-content/uploads/2024/12/IMG_20140330_210511-2048x1689.jpeg 2048w" width="1024"/></picture><figcaption class="wp-element-caption">Original Nexenta Setup</figcaption></figure>
<p>The number one rule is to ALWAYS give ZFS access to the underlying raw storage. You don‚Äôt want a raid controller or anything else interfering with the IO path. This is similar to how vSAN works with VMware.</p>
<p>But rules are meant to be broken right‚Ä¶.. I have virtualized a few copies of TrueNAS Scale and Core which uses ZFS on top of VMware and in these particular instances I specifically DON‚ÄôT want to pass through the storage in the of an HBA or drives of an HBA or drives. Why would I do this? Mainly of two reasons. This allows me to test upgrades of my physical TrueNAS setup with an easy rollback if needed by not passing the drives or controllers in I can clone and snapshot the VMss just as if it was any other and move it around my lab infrastructure.</p>
<h2 class="wp-block-heading" id="w">Copy on Write</h2>
<p>ZFS is a ‚ÄúCopy on Write‚Äù file system which means that it never overwrites existing blocks of storage. It always places writes into new blocks. This is unfriendly with ‚Äúthin provisioning‚Äù something I am a huge fan of. This means that over time even a tiny database writing one megabyte file over and over again will slowly clog the entire file system.</p>
<p>So if you‚Äôre going to break the rules. The way I see it is you might as well do it properly</p>
<p>The first requirement is that the VM‚Äôs be provisioned with thin disks in vSphere. If is not thin then unmap won‚Äôt work. This is important in case you are thin at the underlay storage level.</p>
<h2 class="wp-block-heading" id="disk-i-ds">Disk IDs</h2>
<p>You also need to do is to to ensure that TrueNAS can see unique disk IDs. To do this shut down the VM‚Äôs and add the following parameter to the VMware VM‚Äôs configuration</p>
<div class="code-block-wrapper" style="position: relative; margin: 1em 0;"><pre class="wp-block-code"><code> disk.EnableUUID=TRUE</code></pre><button aria-label="Copy code to clipboard" class="copy-code-button" style="position: absolute; top: 8px; right: 8px; 
                padding: 6px 12px; background: #2d3748; color: #fff; 
                border: 1px solid #4a5568; border-radius: 4px; 
                cursor: pointer; font-size: 12px; font-family: sans-serif;
                opacity: 0.8; transition: opacity 0.2s, background 0.2s;
                z-index: 10;">üìã Copy</button></div>
<p>Once this is done when you power the VM‚Äôs on you should be able to see unique serials of each disk similar to this screenshot Prior to this change, the serial section is blank.</p>
<figure class="wp-block-image size-large"><picture><source srcset="/wp-content/uploads/2024/12/Disk-Serials-1024x125.avif" type="image/avif"/><source srcset="/wp-content/uploads/2024/12/Disk-Serials-1024x125.webp" type="image/webp"/><img alt="" class="wp-image-6278" decoding="async" height="125" loading="eager" sizes="(max-width: 1024px) 100vw, 1024px" src="/wp-content/uploads/2024/12/Disk-Serials-1024x125.png" srcset="/wp-content/uploads/2024/12/Disk-Serials-1024x125.png 1024w, /wp-content/uploads/2024/12/Disk-Serials-300x37.png 300w, /wp-content/uploads/2024/12/Disk-Serials-768x94.png 768w, /wp-content/uploads/2024/12/Disk-Serials-1536x188.png 1536w, /wp-content/uploads/2024/12/Disk-Serials-2048x251.png 2048w" width="1024"/></picture></figure>
<h2 class="wp-block-heading" id="To confirm that trim is working execute the below command command">Trim</h2>
<p>Once the disks are seen as unique it is possible to enable To confirm that trim is working execute the below command command. ( I have no idea why this is a blocker but it is)</p>
<p>You can enable auto To confirm that trim is working execute the below command command in the Storage Dashboard under ‚ÄúZFS Health‚Äù</p>
<p>I decided to manually enable it by executing the below command command in the shell. ( my Pool is called Pool-1)</p>
<div class="code-block-wrapper" style="position: relative; margin: 1em 0;"><pre class="wp-block-code"><code>sudo zpool To confirm that trim is working execute the below command command Pool-1</code></pre><button aria-label="Copy code to clipboard" class="copy-code-button" style="position: absolute; top: 8px; right: 8px; 
                padding: 6px 12px; background: #2d3748; color: #fff; 
                border: 1px solid #4a5568; border-radius: 4px; 
                cursor: pointer; font-size: 12px; font-family: sans-serif;
                opacity: 0.8; transition: opacity 0.2s, background 0.2s;
                z-index: 10;">üìã Copy</button></div>
<p>To confirm that To confirm that trim is working execute the below command command is working execute the below command command</p>
<div class="code-block-wrapper" style="position: relative; margin: 1em 0;"><pre class="wp-block-code"><code>sudo zpool status Pool-1</code></pre><button aria-label="Copy code to clipboard" class="copy-code-button" style="position: absolute; top: 8px; right: 8px; 
                padding: 6px 12px; background: #2d3748; color: #fff; 
                border: 1px solid #4a5568; border-radius: 4px; 
                cursor: pointer; font-size: 12px; font-family: sans-serif;
                opacity: 0.8; transition: opacity 0.2s, background 0.2s;
                z-index: 10;">üìã Copy</button></div>
<p>If everything is working you will see the To confirm that trim is working execute the below command command command as per below command</p>
<figure class="wp-block-image size-large"><img alt="" class="wp-image-6280" decoding="async" loading="lazy" src="/wp-content/uploads/2024/12/To confirm that trim is working execute the below command command-1-1024x452.png"/></figure>
<p>A further validation that this is working is to review the VMss storage used, see the before and after of this VMss</p>
<figure class="wp-block-image wp-block-gallery has-nested-images columns-default is-cropped wp-block-gallery-1 is-layout-flex wp-block-gallery-is-layout-flex"><picture><source srcset="/wp-content/uploads/2024/12/vm-Before-2.avif" type="image/avif"/><source srcset="/wp-content/uploads/2024/12/vm-Before-2.webp" type="image/webp"/><img alt="" class="wp-image-6263" decoding="async" height="609" loading="lazy" sizes="auto, (max-width: 543px) 100vw, 543px" src="/wp-content/uploads/2024/12/vm-Before-2.png" srcset="/wp-content/uploads/2024/12/vm-Before-2.png 543w, /wp-content/uploads/2024/12/vm-Before-2-267x300.png 267w" width="543"/></picture></figure>
<p>Additional confirmation can be seen by reviewing the underlying (vSAN consumption in this case). Before and after listed below command</p>
<figure class="wp-block-image size-full is-resized is-style-default"><picture><source srcset="/wp-content/uploads/2024/12/vSAN-Before.avif" type="image/avif"/><source srcset="/wp-content/uploads/2024/12/vSAN-Before.webp" type="image/webp"/><img alt="" class="wp-image-6275" decoding="async" height="234" loading="lazy" sizes="auto, (max-width: 860px) 100vw, 860px" src="/wp-content/uploads/2024/12/vSAN-Before.png" srcset="/wp-content/uploads/2024/12/vSAN-Before.png 860w, /wp-content/uploads/2024/12/vSAN-Before-300x82.png 300w, /wp-content/uploads/2024/12/vSAN-Before-768x209.png 768w" width="860"/></picture></figure>
<figure class="wp-block-image size-full is-resized"><picture><source srcset="/wp-content/uploads/2024/12/vSAN-After-1.avif" type="image/avif"/><source srcset="/wp-content/uploads/2024/12/vSAN-After-1.webp" type="image/webp"/><img alt="" class="wp-image-6276" decoding="async" height="132" loading="lazy" sizes="auto, (max-width: 353px) 100vw, 353px" src="/wp-content/uploads/2024/12/vSAN-After-1.png" srcset="/wp-content/uploads/2024/12/vSAN-After-1.png 353w, /wp-content/uploads/2024/12/vSAN-After-1-300x112.png 300w" width="353"/></picture></figure>
</div><!-- .entry-content -->
<div class="comments-area" id="comments"><div class="pb-30"><section id="utterances-comments"><script async="" crossorigin="anonymous" data-cfasync="false" data-issue-term="pathname" data-repo="jameskilbynet/jkcoukblog" data-theme="github-dark" src="https://utteranc.es/client.js"></script></section></div></div><footer class="entry-footer">
<div class="entry-tags">
<span class="tags-links">
<span class="tags-label screen-reader-text">
			Post Tags:		</span>
<a class="tag-link tag-item-homelab" href="/tag/homelab/" rel="tag" title="Homelab"><span class="tag-hash">#</span>Homelab</a><a class="tag-link tag-item-trim" href="/tag/trim/" rel="tag" title="Trim"><span class="tag-hash">#</span>Trim</a><a class="tag-link tag-item-unmap" href="/tag/unmap/" rel="tag" title="UNMAP"><span class="tag-hash">#</span>UNMAP</a><a class="tag-link tag-item-vmware" href="/tag/vmware/" rel="tag" title="VMware"><span class="tag-hash">#</span>VMware</a><a class="tag-link tag-item-zfs" href="/tag/zfs/" rel="tag" title="ZFS"><span class="tag-hash">#</span>ZFS</a> </span>
</div><!-- .entry-tags -->
</footer><!-- .entry-footer -->
</div>
</article><!-- #post-6247 -->
<nav aria-label="Posts" class="navigation post-navigation">
<h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="/2024/10/self-hosting-ai-stack-using-vsphere-docker-and-nvidia-gpu/" rel="prev"><div class="post-navigation-sub"><small><span class="kadence-svg-iconset svg-baseline"><svg aria-hidden="true" class="kadence-svg-icon kadence-arrow-left-alt-svg" fill="currentColor" height="28" version="1.1" viewbox="0 0 29 28" width="29" xmlns="http://www.w3.org/2000/svg"><title>Previous</title><path d="M28 12.5v3c0 0.281-0.219 0.5-0.5 0.5h-19.5v3.5c0 0.203-0.109 0.375-0.297 0.453s-0.391 0.047-0.547-0.078l-6-5.469c-0.094-0.094-0.156-0.219-0.156-0.359v0c0-0.141 0.063-0.281 0.156-0.375l6-5.531c0.156-0.141 0.359-0.172 0.547-0.094 0.172 0.078 0.297 0.25 0.297 0.453v3.5h19.5c0.281 0 0.5 0.219 0.5 0.5z"></path>
</svg></span>Previous</small></div>Self Hosting AI Stack using vSphere, Docker and NVIDIA GPU</a></div><div class="nav-next"><a href="/2025/01/how-i-migrated-from-pocket-to-hoarder-and-introduced-some-ai-along-the-way/" rel="next"><div class="post-navigation-sub"><small>Next<span class="kadence-svg-iconset svg-baseline"><svg aria-hidden="true" class="kadence-svg-icon kadence-arrow-right-alt-svg" fill="currentColor" height="28" version="1.1" viewbox="0 0 27 28" width="27" xmlns="http://www.w3.org/2000/svg"><title>Continue</title><path d="M27 13.953c0 0.141-0.063 0.281-0.156 0.375l-6 5.531c-0.156 0.141-0.359 0.172-0.547 0.094-0.172-0.078-0.297-0.25-0.297-0.453v-3.5h-19.5c-0.281 0-0.5-0.219-0.5-0.5v-3c0-0.281 0.219-0.5 0.5-0.5h19.5v-3.5c0-0.203 0.109-0.375 0.297-0.453s0.391-0.047 0.547 0.078l6 5.469c0.094 0.094 0.156 0.219 0.156 0.359v0z"></path>
</svg></span></small></div>How I Migrated from Pocket to Hoarder with AI Integration</a></div></div>
</nav> <div class="entry-related alignfull entry-related-style-wide">
<div class="entry-related-inner content-container site-container">
<div class="entry-related-inner-content alignwide">
<h2 class="entry-related-title" id="related-posts-title">Similar Posts</h2> <div aria-labelledby="related-posts-title" class="entry-related-carousel kadence-slide-init splide" data-columns-md="3" data-columns-sm="2" data-columns-ss="1" data-columns-xl="3" data-columns-xs="2" data-columns-xxl="3" data-slider-anim-speed="400" data-slider-arrows="true" data-slider-auto="false" data-slider-dots="true" data-slider-gutter="40" data-slider-hover-pause="false" data-slider-loop="true" data-slider-next-label="Next" data-slider-prev-label="Previous" data-slider-scroll="1" data-slider-slide-label="Posts" data-slider-speed="7000">
<div class="splide__track">
<ul class="splide__list kadence-posts-list grid-cols grid-sm-col-2 grid-lg-col-3">
<li class="entry-list-item carousel-item splide__slide"><article class="entry content-bg loop-entry post-4370 post type-post status-publish format-standard has-post-thumbnail hentry category-homelab category-storage category-vexpert tag-homelab tag-intel tag-optane tag-truenas tag-truenas-scale tag-vexpert tag-vmware">
<a aria-hidden="true" aria-label="Intel Optane NVMe Homelab" class="post-thumbnail kadence-thumbnail-ratio-2-3" href="/2023/04/intel-optane/" role="presentation" tabindex="-1">
<div class="post-thumbnail-inner">
<picture><source srcset="/wp-content/uploads/2023/04/intel_optane_ssd_900p_series_aic_-_right_angle_575px.avif" type="image/avif"/><source srcset="/wp-content/uploads/2023/04/intel_optane_ssd_900p_series_aic_-_right_angle_575px.webp" type="image/webp"/><img alt="Intel Optane NVMe Homelab" class="attachment-medium_large size-medium_large wp-post-image" decoding="async" height="665" loading="lazy" sizes="(max-width: 480px) 95vw, (max-width: 768px) 90vw, 400px" src="/wp-content/uploads/2023/04/intel_optane_ssd_900p_series_aic_-_right_angle_575px.png" srcset="/wp-content/uploads/2023/04/intel_optane_ssd_900p_series_aic_-_right_angle_575px.png 678w, /wp-content/uploads/2023/04/intel_optane_ssd_900p_series_aic_-_right_angle_575px-300x294.png 300w" width="678"/></picture> </div>
</a><!-- .post-thumbnail -->
<div class="entry-content-wrap">
<header class="entry-header">
<div class="entry-taxonomies">
<span class="category-links term-links category-style-normal">
<a class="category-link-homelab" href="/category/homelab/" rel="tag">Homelab</a> | <a class="category-link-storage" href="/category/storage/" rel="tag">Storage</a> | <a class="category-link-vexpert" href="/category/vexpert/" rel="tag">vExpert</a> </span>
</div><!-- .entry-taxonomies -->
<h3 class="entry-title"><a href="/2023/04/intel-optane/" rel="bookmark">Intel Optane NVMe Homelab</a></h3><div class="entry-meta entry-meta-divider-dot">
<span class="posted-by"><span class="meta-label">By</span><span class="author vcard"><a class="url fn n" href="https://jameskilby.co.uk">James</a></span></span> <span class="posted-on">
<time class="entry-date published" datetime="2023-04-17T12:20:04+00:00" itemprop="datePublished">April 17, 2023</time><time class="updated" datetime="2025-10-01T15:22:13+00:00" itemprop="dateModified">October 1, 2025</time> </span>
</div><!-- .entry-meta -->
</header><!-- .entry-header -->
<div class="entry-summary">
<p>I have been a VMware vExpert for many years and it has brought me many many benefits over the years. I don‚Äôt think it‚Äôs an understatement to say I probably wouldn‚Äôt have my current role within VMware without it. One of the best benefits has been access to a huge amount of licences for VMware‚Ä¶</p>
</div><!-- .entry-summary -->
<footer class="entry-footer">
<div class="entry-actions">
<p class="more-link-wrap">
<a class="post-more-link" href="/2023/04/intel-optane/">
				Read More<span class="screen-reader-text"> Intel Optane NVMe Homelab</span><span class="kadence-svg-iconset svg-baseline"><svg aria-hidden="true" class="kadence-svg-icon kadence-arrow-right-alt-svg" fill="currentColor" height="28" version="1.1" viewbox="0 0 27 28" width="27" xmlns="http://www.w3.org/2000/svg"><title>Continue</title><path d="M27 13.953c0 0.141-0.063 0.281-0.156 0.375l-6 5.531c-0.156 0.141-0.359 0.172-0.547 0.094-0.172-0.078-0.297-0.25-0.297-0.453v-3.5h-19.5c-0.281 0-0.5-0.219-0.5-0.5v-3c0-0.281 0.219-0.5 0.5-0.5h19.5v-3.5c0-0.203 0.109-0.375 0.297-0.453s0.391-0.047 0.547 0.078l6 5.469c0.094 0.094 0.156 0.219 0.156 0.359v0z"></path>
</svg></span> </a>
</p>
</div><!-- .entry-actions -->
</footer><!-- .entry-footer -->
</div>
</article>
</li><li class="entry-list-item carousel-item splide__slide"><article class="entry content-bg loop-entry post-4866 post type-post status-publish format-standard has-post-thumbnail hentry category-vmware category-vcf tag-holodeck tag-multihost tag-vcf tag-vmware">
<a aria-hidden="true" aria-label="MultiHost Holodeck VCF" class="post-thumbnail kadence-thumbnail-ratio-2-3" href="/2024/01/multihost-holodeck-vcf/" role="presentation" tabindex="-1">
<div class="post-thumbnail-inner">
<picture><source srcset="/wp-content/uploads/2023/12/Holodeck-Overview.avif" type="image/avif"/><source srcset="/wp-content/uploads/2023/12/Holodeck-Overview.webp" type="image/webp"/><img alt="MultiHost Holodeck VCF" class="attachment-medium_large size-medium_large wp-post-image" decoding="async" height="239" loading="lazy" sizes="(max-width: 480px) 95vw, (max-width: 768px) 90vw, 400px" src="/wp-content/uploads/2023/12/Holodeck-Overview.png" srcset="/wp-content/uploads/2023/12/Holodeck-Overview.png 523w, /wp-content/uploads/2023/12/Holodeck-Overview-300x137.png 300w" width="523"/></picture> </div>
</a><!-- .post-thumbnail -->
<div class="entry-content-wrap">
<header class="entry-header">
<div class="entry-taxonomies">
<span class="category-links term-links category-style-normal">
<a class="category-link-vmware" href="/category/vmware/" rel="tag">VMware</a> | <a class="category-link-vcf" href="/category/vmware/vcf/" rel="tag">VCF</a> </span>
</div><!-- .entry-taxonomies -->
<h3 class="entry-title"><a href="/2024/01/multihost-holodeck-vcf/" rel="bookmark">MultiHost Holodeck VCF</a></h3><div class="entry-meta entry-meta-divider-dot">
<span class="posted-by"><span class="meta-label">By</span><span class="author vcard"><a class="url fn n" href="https://jameskilby.co.uk">James</a></span></span> <span class="posted-on">
<time class="entry-date published" datetime="2024-01-17T17:29:38+00:00" itemprop="datePublished">January 17, 2024</time><time class="updated" datetime="2026-01-18T21:41:39+00:00" itemprop="dateModified">January 18, 2026</time> </span>
</div><!-- .entry-meta -->
</header><!-- .entry-header -->
<div class="entry-summary">
<p>How to Deploy VMware Holodeck on multiple hosts</p>
</div><!-- .entry-summary -->
<footer class="entry-footer">
<div class="entry-actions">
<p class="more-link-wrap">
<a class="post-more-link" href="/2024/01/multihost-holodeck-vcf/">
				Read More<span class="screen-reader-text"> MultiHost Holodeck VCF</span><span class="kadence-svg-iconset svg-baseline"><svg aria-hidden="true" class="kadence-svg-icon kadence-arrow-right-alt-svg" fill="currentColor" height="28" version="1.1" viewbox="0 0 27 28" width="27" xmlns="http://www.w3.org/2000/svg"><title>Continue</title><path d="M27 13.953c0 0.141-0.063 0.281-0.156 0.375l-6 5.531c-0.156 0.141-0.359 0.172-0.547 0.094-0.172-0.078-0.297-0.25-0.297-0.453v-3.5h-19.5c-0.281 0-0.5-0.219-0.5-0.5v-3c0-0.281 0.219-0.5 0.5-0.5h19.5v-3.5c0-0.203 0.109-0.375 0.297-0.453s0.391-0.047 0.547 0.078l6 5.469c0.094 0.094 0.156 0.219 0.156 0.359v0z"></path>
</svg></span> </a>
</p>
</div><!-- .entry-actions -->
</footer><!-- .entry-footer -->
</div>
</article>
</li><li class="entry-list-item carousel-item splide__slide"><article class="entry content-bg loop-entry post-6765 post type-post status-publish format-standard has-post-thumbnail hentry category-vmware category-vmware-cloud-on-aws tag-sizing tag-vmc tag-vmware-cloud-on-aws">
<a aria-hidden="true" aria-label="VMC Quick Sizing Guide" class="post-thumbnail kadence-thumbnail-ratio-2-3" href="/2025/05/vmc-quick-sizing-guide/" role="presentation" tabindex="-1">
<div class="post-thumbnail-inner">
<picture><source srcset="/wp-content/uploads/2025/02/Picture-1-e1768509620339-768x193.avif" type="image/avif"/><source srcset="/wp-content/uploads/2025/02/Picture-1-e1768509620339-768x193.webp" type="image/webp"/><img alt="VMC Quick Sizing Guide" class="attachment-medium_large size-medium_large wp-post-image" decoding="async" height="193" loading="lazy" sizes="(max-width: 480px) 95vw, (max-width: 768px) 90vw, 400px" src="/wp-content/uploads/2025/02/Picture-1-e1768509620339-768x193.png" srcset="/wp-content/uploads/2025/02/Picture-1-e1768509620339-768x193.png 768w, /wp-content/uploads/2025/02/Picture-1-e1768509620339-300x75.png 300w, /wp-content/uploads/2025/02/Picture-1-e1768509620339.png 816w" width="768"/></picture> </div>
</a><!-- .post-thumbnail -->
<div class="entry-content-wrap">
<header class="entry-header">
<div class="entry-taxonomies">
<span class="category-links term-links category-style-normal">
<a class="category-link-vmware" href="/category/vmware/" rel="tag">VMware</a> | <a class="category-link-vmware-cloud-on-aws" href="/category/vmware/vmware-cloud-on-aws/" rel="tag">VMware Cloud on AWS</a> </span>
</div><!-- .entry-taxonomies -->
<h3 class="entry-title"><a href="/2025/05/vmc-quick-sizing-guide/" rel="bookmark">VMC Quick Sizing Guide</a></h3><div class="entry-meta entry-meta-divider-dot">
<span class="posted-by"><span class="meta-label">By</span><span class="author vcard"><a class="url fn n" href="https://jameskilby.co.uk">James</a></span></span> <span class="posted-on">
<time class="entry-date published" datetime="2025-05-21T09:33:04+00:00" itemprop="datePublished">May 21, 2025</time><time class="updated" datetime="2025-07-02T08:39:59+00:00" itemprop="dateModified">July 2, 2025</time> </span>
</div><!-- .entry-meta -->
</header><!-- .entry-header -->
<div class="entry-summary">
<p>Quick reference guide to the available storage resources that you get in VMware Cloud on AWS</p>
</div><!-- .entry-summary -->
<footer class="entry-footer">
<div class="entry-actions">
<p class="more-link-wrap">
<a class="post-more-link" href="/2025/05/vmc-quick-sizing-guide/">
				Read More<span class="screen-reader-text"> VMC Quick Sizing Guide</span><span class="kadence-svg-iconset svg-baseline"><svg aria-hidden="true" class="kadence-svg-icon kadence-arrow-right-alt-svg" fill="currentColor" height="28" version="1.1" viewbox="0 0 27 28" width="27" xmlns="http://www.w3.org/2000/svg"><title>Continue</title><path d="M27 13.953c0 0.141-0.063 0.281-0.156 0.375l-6 5.531c-0.156 0.141-0.359 0.172-0.547 0.094-0.172-0.078-0.297-0.25-0.297-0.453v-3.5h-19.5c-0.281 0-0.5-0.219-0.5-0.5v-3c0-0.281 0.219-0.5 0.5-0.5h19.5v-3.5c0-0.203 0.109-0.375 0.297-0.453s0.391-0.047 0.547 0.078l6 5.469c0.094 0.094 0.156 0.219 0.156 0.359v0z"></path>
</svg></span> </a>
</p>
</div><!-- .entry-actions -->
</footer><!-- .entry-footer -->
</div>
</article>
</li><li class="entry-list-item carousel-item splide__slide"><article class="entry content-bg loop-entry post-4357 post type-post status-publish format-standard has-post-thumbnail hentry category-homelab category-storage tag-nas tag-truenas-scale tag-zfs">
<a aria-hidden="true" aria-label="Homelab Storage Refresh (Part 1)" class="post-thumbnail kadence-thumbnail-ratio-2-3" href="/2023/05/homelab-storage-refresh-part-1/" role="presentation" tabindex="-1">
<div class="post-thumbnail-inner">
<picture><source srcset="/wp-content/uploads/2023/05/Screenshot-2023-05-22-at-18.49.21-768x198.avif" type="image/avif"/><source srcset="/wp-content/uploads/2023/05/Screenshot-2023-05-22-at-18.49.21-768x198.webp" type="image/webp"/><img alt="TrueNAS Logo" class="attachment-medium_large size-medium_large wp-post-image" decoding="async" height="198" loading="lazy" sizes="(max-width: 480px) 95vw, (max-width: 768px) 90vw, 400px" src="/wp-content/uploads/2023/05/Screenshot-2023-05-22-at-18.49.21-768x198.png" srcset="/wp-content/uploads/2023/05/Screenshot-2023-05-22-at-18.49.21-768x198.png 768w, /wp-content/uploads/2023/05/Screenshot-2023-05-22-at-18.49.21-300x77.png 300w, /wp-content/uploads/2023/05/Screenshot-2023-05-22-at-18.49.21.png 905w" width="768"/></picture> </div>
</a><!-- .post-thumbnail -->
<div class="entry-content-wrap">
<header class="entry-header">
<div class="entry-taxonomies">
<span class="category-links term-links category-style-normal">
<a class="category-link-homelab" href="/category/homelab/" rel="tag">Homelab</a> | <a class="category-link-storage" href="/category/storage/" rel="tag">Storage</a> </span>
</div><!-- .entry-taxonomies -->
<h3 class="entry-title"><a href="/2023/05/homelab-storage-refresh-part-1/" rel="bookmark">Homelab Storage Refresh (Part 1)</a></h3><div class="entry-meta entry-meta-divider-dot">
<span class="posted-by"><span class="meta-label">By</span><span class="author vcard"><a class="url fn n" href="https://jameskilby.co.uk">James</a></span></span> <span class="posted-on">
<time class="entry-date published" datetime="2023-05-23T12:07:09+00:00" itemprop="datePublished">May 23, 2023</time><time class="updated" datetime="2025-10-01T15:22:13+00:00" itemprop="dateModified">October 1, 2025</time> </span>
</div><!-- .entry-meta -->
</header><!-- .entry-header -->
<div class="entry-summary">
<p>Table of Contents Background ZFS Overview Read Cache (ARC and L2ARC) ZIL (ZFS Intent Log) Hardware Background I have just completed the move of all my production and media-based storage/services to TrueNAS Scale. ( I will just refer to this as TrueNAS) This is based on my HP Z840 and I have now retired my‚Ä¶</p>
</div><!-- .entry-summary -->
<footer class="entry-footer">
<div class="entry-actions">
<p class="more-link-wrap">
<a class="post-more-link" href="/2023/05/homelab-storage-refresh-part-1/">
				Read More<span class="screen-reader-text"> Homelab Storage Refresh (Part 1)</span><span class="kadence-svg-iconset svg-baseline"><svg aria-hidden="true" class="kadence-svg-icon kadence-arrow-right-alt-svg" fill="currentColor" height="28" version="1.1" viewbox="0 0 27 28" width="27" xmlns="http://www.w3.org/2000/svg"><title>Continue</title><path d="M27 13.953c0 0.141-0.063 0.281-0.156 0.375l-6 5.531c-0.156 0.141-0.359 0.172-0.547 0.094-0.172-0.078-0.297-0.25-0.297-0.453v-3.5h-19.5c-0.281 0-0.5-0.219-0.5-0.5v-3c0-0.281 0.219-0.5 0.5-0.5h19.5v-3.5c0-0.203 0.109-0.375 0.297-0.453s0.391-0.047 0.547 0.078l6 5.469c0.094 0.094 0.156 0.219 0.156 0.359v0z"></path>
</svg></span> </a>
</p>
</div><!-- .entry-actions -->
</footer><!-- .entry-footer -->
</div>
</article>
</li><li class="entry-list-item carousel-item splide__slide"><article class="entry content-bg loop-entry post-5343 post type-post status-publish format-standard has-post-thumbnail hentry category-vcf category-vmware tag-cpu tag-holodeck tag-homelab tag-vmware">
<a aria-hidden="true" aria-label="Holodeck CPU Fixes" class="post-thumbnail kadence-thumbnail-ratio-2-3" href="/2024/01/holodeck-cpu-fixes/" role="presentation" tabindex="-1">
<div class="post-thumbnail-inner">
<picture><source srcset="/wp-content/uploads/2024/01/40oOd8IipPvtrPJs-1198788743-768x737.avif" type="image/avif"/><source srcset="/wp-content/uploads/2024/01/40oOd8IipPvtrPJs-1198788743-768x737.webp" type="image/webp"/><img alt="Holodeck CPU Fixes" class="attachment-medium_large size-medium_large wp-post-image" decoding="async" height="737" loading="lazy" sizes="(max-width: 480px) 95vw, (max-width: 768px) 90vw, 400px" src="/wp-content/uploads/2024/01/40oOd8IipPvtrPJs-1198788743-768x737.jpg" srcset="/wp-content/uploads/2024/01/40oOd8IipPvtrPJs-1198788743-768x737.jpg 768w, /wp-content/uploads/2024/01/40oOd8IipPvtrPJs-1198788743-300x288.jpg 300w, /wp-content/uploads/2024/01/40oOd8IipPvtrPJs-1198788743.jpg 1000w" width="768"/></picture> </div>
</a><!-- .post-thumbnail -->
<div class="entry-content-wrap">
<header class="entry-header">
<div class="entry-taxonomies">
<span class="category-links term-links category-style-normal">
<a class="category-link-vcf" href="/category/vmware/vcf/" rel="tag">VCF</a> | <a class="category-link-vmware" href="/category/vmware/" rel="tag">VMware</a> </span>
</div><!-- .entry-taxonomies -->
<h3 class="entry-title"><a href="/2024/01/holodeck-cpu-fixes/" rel="bookmark">Holodeck CPU Fixes</a></h3><div class="entry-meta entry-meta-divider-dot">
<span class="posted-by"><span class="meta-label">By</span><span class="author vcard"><a class="url fn n" href="https://jameskilby.co.uk">James</a></span></span> <span class="posted-on">
<time class="entry-date published" datetime="2024-01-18T14:37:04+00:00" itemprop="datePublished">January 18, 2024</time><time class="updated" datetime="2024-07-10T07:21:58+00:00" itemprop="dateModified">July 10, 2024</time> </span>
</div><!-- .entry-meta -->
</header><!-- .entry-header -->
<div class="entry-summary">
<p>How to deploy Holodeck with Legacy CPU‚Äôs</p>
</div><!-- .entry-summary -->
<footer class="entry-footer">
<div class="entry-actions">
<p class="more-link-wrap">
<a class="post-more-link" href="/2024/01/holodeck-cpu-fixes/">
				Read More<span class="screen-reader-text"> Holodeck CPU Fixes</span><span class="kadence-svg-iconset svg-baseline"><svg aria-hidden="true" class="kadence-svg-icon kadence-arrow-right-alt-svg" fill="currentColor" height="28" version="1.1" viewbox="0 0 27 28" width="27" xmlns="http://www.w3.org/2000/svg"><title>Continue</title><path d="M27 13.953c0 0.141-0.063 0.281-0.156 0.375l-6 5.531c-0.156 0.141-0.359 0.172-0.547 0.094-0.172-0.078-0.297-0.25-0.297-0.453v-3.5h-19.5c-0.281 0-0.5-0.219-0.5-0.5v-3c0-0.281 0.219-0.5 0.5-0.5h19.5v-3.5c0-0.203 0.109-0.375 0.297-0.453s0.391-0.047 0.547 0.078l6 5.469c0.094 0.094 0.156 0.219 0.156 0.359v0z"></path>
</svg></span> </a>
</p>
</div><!-- .entry-actions -->
</footer><!-- .entry-footer -->
</div>
</article>
</li><li class="entry-list-item carousel-item splide__slide"><article class="entry content-bg loop-entry post-6 post type-post status-publish format-standard hentry category-homelab category-storage category-synology tag-homelab tag-storage">
<div class="entry-content-wrap">
<header class="entry-header">
<div class="entry-taxonomies">
<span class="category-links term-links category-style-normal">
<a class="category-link-homelab" href="/category/homelab/" rel="tag">Homelab</a> | <a class="category-link-storage" href="/category/storage/" rel="tag">Storage</a> | <a class="category-link-synology" href="/category/synology/" rel="tag">Synology</a> </span>
</div><!-- .entry-taxonomies -->
<h3 class="entry-title"><a href="/2018/01/lab-storage/" rel="bookmark">Lab Storage</a></h3><div class="entry-meta entry-meta-divider-dot">
<span class="posted-by"><span class="meta-label">By</span><span class="author vcard"><a class="url fn n" href="https://jameskilby.co.uk">James</a></span></span> <span class="posted-on">
<time class="entry-date published" datetime="2018-01-06T17:39:20+00:00" itemprop="datePublished">January 6, 2018</time><time class="updated" datetime="2024-07-10T08:56:51+00:00" itemprop="dateModified">July 10, 2024</time> </span>
</div><!-- .entry-meta -->
</header><!-- .entry-header -->
<div class="entry-summary">
<p>I have been meaning to post around some of the lab setup for a while.¬† ¬†Although it changes frequently at present it‚Äôs as below.¬† I will add some pics when I have tidied up the lab/cables My primary lab storage is all contained within an HP Gen8 Microserver. Currently Configured: 1x¬†INTEL Core i3-4130 running at‚Ä¶</p>
</div><!-- .entry-summary -->
<footer class="entry-footer">
<div class="entry-actions">
<p class="more-link-wrap">
<a class="post-more-link" href="/2018/01/lab-storage/">
				Read More<span class="screen-reader-text"> Lab Storage</span><span class="kadence-svg-iconset svg-baseline"><svg aria-hidden="true" class="kadence-svg-icon kadence-arrow-right-alt-svg" fill="currentColor" height="28" version="1.1" viewbox="0 0 27 28" width="27" xmlns="http://www.w3.org/2000/svg"><title>Continue</title><path d="M27 13.953c0 0.141-0.063 0.281-0.156 0.375l-6 5.531c-0.156 0.141-0.359 0.172-0.547 0.094-0.172-0.078-0.297-0.25-0.297-0.453v-3.5h-19.5c-0.281 0-0.5-0.219-0.5-0.5v-3c0-0.281 0.219-0.5 0.5-0.5h19.5v-3.5c0-0.203 0.109-0.375 0.297-0.453s0.391-0.047 0.547 0.078l6 5.469c0.094 0.094 0.156 0.219 0.156 0.359v0z"></path>
</svg></span> </a>
</p>
</div><!-- .entry-actions -->
</footer><!-- .entry-footer -->
</div>
</article>
</li> </ul>
</div>
</div>
</div>
</div>
</div><!-- .entry-author -->
</div>
</div><!-- #main -->
</div>
</div><!-- #primary -->
</main><!-- #inner-wrap -->
<footer class="site-footer" id="colophon" role="contentinfo">
<div class="site-footer-wrap">
<div class="site-bottom-footer-wrap site-footer-row-container site-footer-focus-item site-footer-row-layout-standard site-footer-row-tablet-layout-default site-footer-row-mobile-layout-default" data-section="kadence_customizer_footer_bottom">
<div class="site-footer-row-container-inner">
<div class="site-container">
<div class="site-bottom-footer-inner-wrap site-footer-row site-footer-row-columns-1 site-footer-row-column-layout-row site-footer-row-tablet-column-layout-default site-footer-row-mobile-column-layout-row ft-ro-dir-row ft-ro-collapse-normal ft-ro-t-dir-default ft-ro-m-dir-default ft-ro-lstyle-plain">
<div class="site-footer-bottom-section-1 site-footer-section footer-section-inner-items-1">
<div class="footer-widget-area site-info site-footer-focus-item content-align-default content-tablet-align-default content-mobile-align-default content-valign-default content-tablet-valign-default content-mobile-valign-default" data-section="kadence_customizer_footer_html">
<div class="footer-widget-area-inner site-info-inner">
<div class="footer-html inner-link-style-normal"><div class="footer-html-inner">
</div></div> </div>
</div><!-- .site-info -->
</div>
</div>
</div>
</div>
</div>
</div>
<div class="content-formats" style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--gray-mid);"><p>Content also available in: <a href="/markdown/">Markdown</a> | <a href="/api/">JSON API</a></p></div></footer><!-- #colophon -->
</div><!-- #wrapper -->
<script>document.documentElement.style.setProperty('--scrollbar-offset', window.innerWidth - document.documentElement.clientWidth + 'px' );</script>
<script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"/*"},{"not":{"href_matches":["/wp-*.php","/wp-admin/*","/wp-content/uploads/*","/wp-content/*","/wp-content/plugins/*","/wp-content/themes/kadence/*","/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>
<div class="popup-drawer popup-drawer-layout-sidepanel popup-drawer-animation-fade popup-drawer-side-right" data-drawer-target-string="#mobile-drawer" id="mobile-drawer">
<div class="drawer-overlay" data-drawer-target-string="#mobile-drawer"></div>
<div class="drawer-inner">
<div class="drawer-header">
<button aria-expanded="false" aria-label="Close menu" class="menu-toggle-close drawer-toggle" data-set-focus=".menu-toggle-open" data-toggle-body-class="showing-popup-drawer-from-right" data-toggle-target="#mobile-drawer">
<span class="toggle-close-bar"></span>
<span class="toggle-close-bar"></span>
</button>
</div>
<div class="drawer-content mobile-drawer-content content-align-left content-valign-top">
<div class="site-header-item site-header-focus-item site-header-item-mobile-navigation mobile-navigation-layout-stretch-false" data-section="kadence_customizer_mobile_navigation">
<nav aria-label="Primary Mobile" class="mobile-navigation drawer-navigation drawer-navigation-parent-toggle-false" id="mobile-site-navigation" role="navigation">
<div class="mobile-menu-container drawer-menu-container">
<ul class="menu has-collapse-sub-nav" id="mobile-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7329"><a href="/about-me/">About Me</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7324"><a href="/evs/">AWS EVS</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7325"><a href="/vmc/">VMC</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7327"><a href="/media/">Media</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7326"><a href="/homelab-software/">HomeLab ‚Äì Software</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7328"><a href="/lab/">Homelab ‚Äì Hardware</a></li>
</ul> </div>
</nav><!-- #site-navigation -->
</div><!-- data-section="mobile_navigation" -->
</div>
</div>
</div>
<script id="wpo_min-footer-0-js-extra">
var kadenceConfig = {"screenReader":{"expand":"Child menu","expandOf":"Child menu of","collapse":"Child menu","collapseOf":"Child menu of"},"breakPoints":{"desktop":"1024","tablet":768},"scrollOffset":"0"};
var kadenceSlideConfig = {"of":"of","to":"to","slide":"Slide","next":"Next","prev":"Previous"};
//# sourceURL=wpo_min-footer-0-js-extra
</script>
<script id="wpo_min-footer-0-js" src="/wp-content/cache/wpo-minify/1769613917/assets/wpo-minify-footer-20d41812.min.js"></script>
<script>
(function() {
    document.querySelectorAll('.copy-code-button').forEach(function(button) {
        button.addEventListener('click', function() {
            var pre = this.previousElementSibling;
            var code = pre.querySelector('code') || pre;
            var text = code.textContent || code.innerText;
            
            // Copy to clipboard
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).then(function() {
                    // Success feedback
                    button.textContent = '‚úÖ Copied!';
                    button.style.background = '#48bb78';
                    setTimeout(function() {
                        button.textContent = 'üìã Copy';
                        button.style.background = '#2d3748';
                    }, 2000);
                }).catch(function() {
                    button.textContent = '‚ùå Failed';
                    setTimeout(function() {
                        button.textContent = 'üìã Copy';
                    }, 2000);
                });
            } else {
                // Fallback for older browsers
                var textarea = document.createElement('textarea');
                textarea.value = text;
                textarea.style.position = 'fixed';
                textarea.style.opacity = '0';
                document.body.appendChild(textarea);
                textarea.select();
                try {
                    document.execCommand('copy');
                    button.textContent = '‚úÖ Copied!';
                    button.style.background = '#48bb78';
                    setTimeout(function() {
                        button.textContent = 'üìã Copy';
                        button.style.background = '#2d3748';
                    }, 2000);
                } catch (err) {
                    button.textContent = '‚ùå Failed';
                    setTimeout(function() {
                        button.textContent = 'üìã Copy';
                    }, 2000);
                }
                document.body.removeChild(textarea);
            }
        });
        
        // Hover effects
        button.addEventListener('mouseenter', function() {
            this.style.opacity = '1';
            this.style.background = '#4a5568';
        });
        button.addEventListener('mouseleave', function() {
            this.style.opacity = '0.8';
            this.style.background = '#2d3748';
        });
    });
})();
</script><script data-cfasync="false" src="/js/search.js"></script>
</body>
</html>
